#!/bin/sh

PLZ_LINK_NAME="${1}";
PLZ_LINK_REVISION="${2}";

PLZ_LINK_LOCATION="${PLZ_APP_STORE}/${PLZ_LINK_NAME}/${PLZ_LINK_REVISION}";
PLZ_LINK_PERSISTENT="${PLZ_PERSISTENT_STORE}/${PLZ_LINK_NAME}/${PLZ_LINK_REVISION}";

echo "Ensuring existence of persistent data store...";
if [ ! -d "${PLZ_LINK_PERSISTENT}" ]; then
  echo "Persistent data not found, creating empty directory...";

  mkdir -p -v "${PLZ_LINK_PERSISTENT}";
fi;

if [ ! -d "${PLZ_LINK_PERSISTENT}" ]; then
  echo "There was an error locating or creating the persistent data store!";
fi;

echo "Linking persistent data store into place...";

ln -v -s "${PLZ_LINK_PERSISTENT}" "${PLZ_LINK_LOCATION}/_persistent";
